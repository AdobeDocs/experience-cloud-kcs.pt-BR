---
title: Analise o crescimento incomum do repositório
description: Descrição
solution: Experience Manager
product: Experience Manager
applies-to: Experience Manager 6.4,Experience Manager 6.5
keywords: KCS
resolution: Resolution
internal-notes: null
bug: false
article-created-by: Roxann McGlumphy
article-created-date: 10/21/2021 9:42:02 PM
article-published-by: Cedric Latimier
article-published-date: 1/18/2022 2:45:04 PM
version-number: 1
article-number: KA-17496
dynamics-url: https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=6654cfb6-b732-ec11-b6e5-000d3a5ba97a
exl-id: 51d503fe-3da6-4cfc-a8c5-95f80da51ae8
source-git-commit: e8f4ca2dd578944d4fe399074fab461de88ad247
workflow-type: tm+mt
source-wordcount: '582'
ht-degree: 1%

---

# Analise o crescimento incomum do repositório

## Descrição


O uso do disco está aumentando de forma anormal e rápida em um servidor AEM.
<br><br><br><br>Causa<br><br><br><br><br><br>
Muitas coisas podem causar aumentos incomuns na utilização do disco.  Algumas causas possíveis:

1. A manutenção adequada não foi executada no sistema.  Consulte [este artigo](https://helpx.adobe.com/experience-manager/kb/AEM6-Maintenance-Guide.html) para obter detalhes sobre várias atividades de manutenção do sistema.
2. AEM ou o aplicativo está criando um número muito grande de nós ou atualizações nas propriedades do nó.  Isso pode ser devido a uma configuração incorreta ou a um bug no código do aplicativo.  Como o armazenamento tar no Oak opera em um modo somente de acréscimo, o salvamento repetido de nós contribui ainda mais para o crescimento excessivo do repositório.
3. Arquivos muito grandes foram carregados no AEM Assets ou no gerenciador de pacotes.
4. O log de depuração ou rastreamento foi deixado ativado.



## Resolução

A. Se AEM estiver em execução e houver espaço em disco amplo<br><br><br><br> <br><br>1. CONFIGURAR O REGISTRO DE TRACE DE GRAVAÇÃO DO OAK<br><br><br><br> <br><br>Se AEM ainda estiver em execução, poderemos ativar um agente de depuração para nos informar quais caminhos do repositório estão sendo gravados.  Para ativar esse logger, instale o pacote de configuração de log anexado abaixo ou siga estas etapas:
1. Ir para <b>*http://aemhost:port*/system/console/slinglog</b>
2. Clique em <b>Adicionar novo logger</b>
3. Configure um logger: <b>Arquivo de log: logs/repgrowth.log</b>, <b>Nível de registro: traçar</b>, <b>Loggers:</b> <b>org.apache.jackrabbit.oak.jcr.operations.writes</b>


DOWNLOAD
[Obter arquivo](https://helpx.adobe.com/content/dam/help/en/experience-manager/kb/analyze-unusual-repository-growth/jcr:content/main-pars/download/log_repository_growth-1.zip "log_repository_growth-1.zip") <br><br>Este pacote contém a configuração necessária para a sessão de gravação de log do oak. Instale este pacote por meio do Gerenciador de pacotes do CRX. Após o período do monitor, desinstale o pacote.<br><br><br><br><br><br><br><br> <br><br><br><br><br><br> <br><br><br><br><br><br><br><br><br>
Cuidado:

- O log inclui informações sobre todas as gravações e detalhes da sessão.  Se você usar esse registrador, verifique se tem espaço em disco suficiente.
- Desinstale o pacote de configuração de log ou remova a configuração de log após um curto período de habilitação para evitar mais consumo de espaço em disco.



<br><br><br><br> <br><br>2. EXECUTE O RELATÓRIO DE USO DO DISCO<br><br><br><br> <br><br>
Você também pode aproveitar o relatório de Uso de disco <b>*http://host:port*/etc/reports/diskusage.html</b>.Este relatório exibe o espaço em disco usado pelo caminho do repositório.  O relatório é pesquisável, permitindo que você visualize subárvores também.
<br><br><br><br> <br><br>3. CAPTURAR DESPEJOS DE ENCADEAMENTO E EXECUTAR PERFIS<br><br><br><br> <br><br>
Depois de usar o <b>[repgrowth.log](https://helpx.adobe.com/experience-manager/kb/analyze-unusual-repository-growth.html#repgrowth)</b> para ter uma ideia de quais dados estão sendo gravados, podemos obter informações sobre qual código está gravando esses dados capturando despejos de encadeamentos e executando a criação de perfis da CPU.

Consulte estes artigos:

- [Criação de perfis da CPU](https://helpx.adobe.com/experience-manager/kb/AnalyzeUsingBuiltInProfiler.html)
- [Capturando despejos de encadeamento](https://helpx.adobe.com/experience-manager/kb/TakeThreadDump.html)
- [Analisando AEM despejos de thread](https://helpx.adobe.com/experience-manager/kb/thread-dump-analysis.html)

<br><br><br><br> <br><br>B. Se o AEM for interrompido e/ou o espaço em disco estiver quase esgotado<br><br><br><br> <br><br>
Se tiver que parar AEM para evitar o crescimento do espaço em disco, use os comandos abaixo para fazer uma análise inicial.

Na plataforma Linux, aproveite o <b>du</b> comando para listar todos os diretórios em <b>crx-quickstart</b> com o tamanho resumido desses diretórios:

du -h —max-depth=2 crx-quickstart

Use <b>find</b> e <b>du</b> comandos para localizar arquivos modificados recentemente e obter seus tamanhos:

encontre crx-quickstart -type f -mtime 1 -exec du -hs {} \; -print

Para localizar arquivos grandes no armazenamento de dados, você pode combinar <b>find</b>, <b>du</b> e <b>arquivo</b> comandos para localizar arquivos acima de 100MB no <b>armazenamento de dados</b> diretório e identificar automaticamente seu tipo de arquivo:

encontrar crx-quickstart/repository/datastore -type f -size +100M -exec sh -c &quot;du -hs \&quot;{}\&quot;; arquivo \&quot;{}\&quot;&quot; \;

Se você achar que o crescimento está ocorrendo no <b>segmentstore</b> , o comando abaixo pode ajudar a dar algumas pistas sobre quais dados estão sendo gravados:

strings data_xxxxx.tar | egrep &#39;.?/&#39; | &quot;s/.$//;s/.\/\///&#39;
