---
title: "Como reindexar um índice de AEM síncrono | AEM, Oak"
description: Descrição
solution: Experience Manager
product: Experience Manager
applies-to: "Experience Manager"
keywords: "KCS, como, Adobe Experience Manager, reindexação, índice de AEM síncrono, Oak"
resolution: Resolution
internal-notes: "Helpx Link: helpx.adobe.com/experience-manager/kb/how-to-reindex-a-synchronous-AEM-index-AEM-Oak.html"
bug: false
article-created-by: Jim Menn
article-created-date: "10/25/2022 3:43:52 PM"
article-published-by: Jim Menn
article-published-date: "10/25/2022 7:23:17 PM"
version-number: 3
article-number: KA-16460
dynamics-url: "https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=c36388d0-7b54-ed11-bba2-6045bd006b4b"
source-git-commit: 778bb0bd3ff76d35a60ce91ebdb3142fa59eda30
workflow-type: tm+mt
source-wordcount: '406'
ht-degree: 0%

---

# Como reindexar um índice de AEM síncrono | AEM, Oak

## Descrição


<b>Ambiente</b>
Adobe Experience Manager

<b>Problema</b>
Como faço para reindexar corretamente um índice Oak síncrono sem causar tempo de inatividade?


## Resolução


<b>Solução</b>
Reindexação de um índice síncrono simplesmente definindo a propriedade reindex como *true* O resulta em uma operação síncrona que pode causar a interrupção de uma instância do Oak.
Para evitar essa situação, envie a indexação para um thread em segundo plano.
Para fazer isso, siga as etapas abaixo:

<b><u>Etapa 1: Reindexe em um encadeamento em segundo plano</u></b>

1. Defina as seguintes propriedades de <b>CRXDE Lite</b> na definição de índice do índice de propriedade a ser ativado para indexação assíncrona:<br>

   ```
   /oak:index/property index
   reindex=true
   reindex-async=true
   ```
2. Para validar se o nó acima atualiza, `async="async-reindex"` deve ser definida.
3. Chame o `startPropertyIndexAsyncReindex` no `PropertyIndexAsyncReindex` MBean.

   Isso iniciaria o trabalho em segundo plano que pesquisaria esses tipos de índices.

   Após a invocação, você deverá ver uma reindexação de linha de log executada..
4. Quando a reindexação estiver concluída, o sinalizador de reindexação será redefinido para *false*.
5. Volte a invocar a etapa 3 para alterar o índice para um índice de sincronização. Se o sinalizador assíncrono não for excluído, o Mbean poderá ter que ser chamado várias vezes (isso pode acontecer se ocorrerem alterações afetando esse índice simultaneamente).



   *Observação:* Somente a variável `async="async-reindex"` será removida, pois controla em qual encadeamento a indexação ocorrerá.

   O `reindex-async` é apenas um sinalizador de configuração que não será alterado automaticamente.

   A ideia é que você o defina uma vez para as definições de índice específicas que controlam todas as reindexações futuras.

   Espera-se então que ele fique lá dentro e que você não precise tocá-lo novamente.


<b><u>Etapa 2: Remova o ponto de verificação de reindexação (somente AEM 6.2 e versões mais antigas)</u></b>

Durante o processo de reindexação assíncrona, um ponto de verificação do repositório é criado.
Depois que a tarefa de indexação for concluída, ela deverá ser liberada conforme descrito abaixo, para garantir a coleção de lixo de revisão sem problemas posteriormente:

1. Primeiro, abra o <b>CheckpointManager</b> MBean:

   No MongoMK - [`/system/console/jmx/org.apache.jackrabbit.oak%3Aname%3DDocument+node+store+checkpoint+management%2Ctype%3DCheckpointManger`](http://localhost:4502/system/console/jmx/org.apache.jackrabbit.oak%3Aname%3DDocument+node+store+checkpoint+management%2Ctype%3DCheckpointManger)

   No TarMK - [`/system/console/jmx/org.apache.jackrabbit.oak%3Aname%3DSegment+node+store+checkpoint+management%2Ctype%3DCheckpointManger`](http://localhost:4502/system/console/jmx/org.apache.jackrabbit.oak%3Aname%3DSegment+node+store+checkpoint+management%2Ctype%3DCheckpointManger)


2. Chame o `listCheckpoints()` operação.
3. Encontre a linha de ponto de verificação com a `name=async-reindex` propriedade.
4. Copie seu valor de id para a área de transferência:

   No MongoMK, será semelhante a isto: `r1234567aaaa-0-1`

   No TarMK, será semelhante a isto: `6eac07d0-fe27-4d16-82f8-6d5da4cefd67`


5. Em seguida, abra o `releaseCheckpoint()` operação.
6. Cole a ID copiada como p1 e clique em <b>Invocar</b>.
7. Esta etapa liberará o ponto de verificação.

