---
title: "AEM redireciona o usuário para http quando acessado por meio de balanceador de carga terminado SSL/TLS | AEM"
description: Descrição
solution: Experience Manager
product: Experience Manager
applies-to: "Experience Manager"
keywords: "KCS"
resolution: Resolution
internal-notes: "Helpx Link: https://helpx.adobe.com/experience-manager/kb/AEM-redirecting-back-to-http-on-accessed-via-SSL-terminated-Load-Balancer.html"
bug: false
article-created-by: Emily Geary
article-created-date: "4/12/2021 6:21:34 PM"
article-published-by: Emily Geary
article-published-date: "4/12/2021 6:26:15 PM"
version-number: 1
article-number: KA-16936
dynamics-url: "https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=684ec8e8-bb9b-eb11-b1ac-000d3a3680d8"
exl-id: 52e50c09-67f2-46a2-90a7-df769d76a0dd
source-git-commit: 0c3e421beca46d9fe1952b1f98538a50697216a0
workflow-type: tm+mt
source-wordcount: '341'
ht-degree: 1%

---

# AEM redireciona o usuário para http quando acessado por meio de balanceador de carga terminado por SSL/TLS | AEM

## Descrição


Ao acessar AEM por meio de um balanceador de carga terminado por SSL (ou CDN terminado por SSL), AEM redireciona de https para http.

A terminação SSL no balanceador de carga significa que os certificados SSL estão instalados no balanceador de carga. O usuário final acessa o site por meio de `https://`e o Dispatcher/Web Server e o AEM são acessados no back-end com `http://`.



<b>Causa</b>

Diferentes balanceadores de carga enviam cabeçalhos diferentes para notificar os sistemas de back-end de que o SSL está encerrado em upstream. Por exemplo, [O Amazon ELB usa o cabeçalho &quot;X-Forwarded-Proto: https&quot;](https://docs.aws.amazon.com/elasticloadbalancing/latest/classic/x-forwarded-headers.html#x-forwarded-proto).


## Resolução


Para corrigir o problema:

<b>I. Atualizar Dispatcher `/clientheaders` configuração</b>

Consulte a documentação do balanceador de carga para descobrir qual cabeçalho ele define para notificar os sistemas downstream que ele encerrou o SSL. Para simplificar, nessas etapas, pressupomos que o cabeçalho HTTP correto é *`X-Forwarded-Proto: https`*

1. Faça logon no servidor do dispatcher.
2. Abra o farm do dispatcher `.any` configuração.
3. Adicione o cabeçalho à `/clientheaders` seção.


Se você estiver usando o dispatcher sem um balanceador de carga ou se o balanceador de carga ou proxy falhar ao definir a variável `X-Forwarded-Proto` , é possível defini-lo no nível do servidor da Web ou do dispatcher. Se estiver usando [!DNL Apache HTTP Server], atualize seu HTTPS VirtualHost com esta diretiva:


| 1 | `RequestHeader ` `set` `X-Forwarded-Proto ` `"https"` |
| --- | --- |


<b>II. Atualize as configurações de cabeçalho:</b>

1. Ir para *http://host:port*/system/console/configMgr/org.apache.felix.http.sslfilter.SslFilter e faça logon como administrador.
2. Defina o cabeçalho de encaminhamento SSL como `X-Forwarded-Proto`.
3. Defina o valor de encaminhamento SSL como https.
4. Clique em Salvar.


Observação:

Não há um padrão para cabeçalhos de proxy reverso que informam ao back-end qual protocolo é usado. No entanto, aqui estão alguns que são conhecidos:

- Amazon ELB ([!DNL Elastic Load Balancer]) usa a variável `X-Forwarded-Proto: https` cabeçalho.
- [!DNL Amazon Cloudfront] Usos da CDN `X-Cloudfront-Proto: https` cabeçalho.


<b>III. Atualizar a configuração do OSGi do Jetty (AEM 6.3 e versões posteriores)</b>

No AEM 6.3 e versões posteriores, é necessária uma configuração adicional:

- Faça logon em http://aem-host:port/system/console/configMgr/org.apache.felix.http.
- Ativar a configuração <b>Habilitar Conexão de Proxy/Balanceador de Carga</b>e salve-o.
