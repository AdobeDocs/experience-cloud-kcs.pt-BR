---
title: "Implementação do Video Analytics no Adobe Launch"
description: Descrição
solution: Customer Journey Analytics,Analytics
product: Customer Journey Analytics,Analytics
applies-to: "Customer Journey Analytics,Analytics"
keywords: "Heartbeat do KCS Launch Video Analytics"
resolution: Resolution
internal-notes: "This implementation discussed in this article does not use Adobe Launch extension for Media Analytics."
bug: false
article-created-by: Krunal Oza
article-created-date: "9/16/2022 9:07:03 AM"
article-published-by: Krunal Oza
article-published-date: "9/16/2022 9:25:26 AM"
version-number: 3
article-number: KA-15023
dynamics-url: "https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=ee0b6fe9-9e35-ed11-9db1-002248086a9c"
source-git-commit: e8f4ca2dd578944d4fe399074fab461de88ad247
workflow-type: tm+mt
source-wordcount: '1055'
ht-degree: 0%

---

# Implementação do Video Analytics no Adobe Launch

## Descrição

<br>Ambiente<br><br>


Este artigo fornece etapas para implementar o rastreamento de vídeo YouTube no Adobe Launch usando o SDK do Media Heartbeat.


<br><br>Problema/Sintomas<br><br>
<b>Pré-requisitos</b>


| <ol>   <li>Você tem uma implementação ativa do Adobe Launch.</li>   <li>O conjunto de relatórios está habilitado para a coleção de mídia.</li>   <li>O conjunto de relatórios é mapeado para corrigir o logon da empresa do Analytics no Adobe Experience Cloud.</li>   <li>Você tem direitos de publicação no Adobe Launch.</li>   <li>Você está familiarizado com a interface do usuário do Adobe Launch e como ela funciona.</li>  </ol><br> |
| --- |



## Resolução


<b>ETAPA 1: Criar nova regra</b>

Crie uma nova regra na propriedade Adobe Launch clicando no botão &quot;Adicionar regra&quot; na guia &quot;Regras&quot;. Essa regra conterá a condição do evento para carregar o vídeo do YouTube e os scripts da API do iFrame do Video Analytics e do YouTube.

- Especifique o nome da regra na caixa de texto Nome .




<b>ETAPA 2: Adicionar eventos e/ou condições</b>

Clique no botão + em Evento e condições para criar condições para iniciar o vídeo do YouTube. No meu exemplo, adicionei uma condição &quot;Element Exists&quot; para procurar um &quot;player&quot; div específico para iniciar o vídeo do YouTube.



<b>ETAPA 3: Adicionar ações - Variáveis de configuração</b>

Clique no botão + em ações para criar um novo item de ação. Isso atuará como um único ponto de configuração para configurar as variáveis do Video Analytics. Eu usei alguns valores codificados. No entanto, você pode usar elementos de dados para preencher essas variáveis.

1. Selecione &quot;Principal&quot; no menu suspenso Extensão.
2. Selecione &quot;Código personalizado&quot; no menu suspenso Tipo de ação .
3. Adicione o nome da Ação na caixa de texto Nome.
4. Selecione &quot;Javascript&quot; em Idioma.
5. Marque &quot;Executar globalmente&quot;.
6. Clique em &quot;Abrir editor&quot;.
7. Adicione o código e clique em salvar. Atualize os valores de acordo com sua empresa e conjunto de relatórios.



```
(function() {    'use strict';
    // Export symbols.
    window.Configuration = {
        PLAYER: {
            NAME: 'sample player name'
            //VIDEO_ID: 'sample video id',
           //VIDEO_NAME: sample video name'
        },
        VISITOR: {
            MARKETING_CLOUD_ORG_ID: 'experience cloud ID',
            TRACKING_SERVER: 'tracking server',
            DPID: '',
            DPUUID: ''
        },
        APP_MEASUREMENT: {
            RSID: 'report suite id',
            TRACKING_SERVER: 'tracking server',
            PAGE_NAME: 'page name',
            CHAR_SET: 'UTF-8'
        },
        HEARTBEAT: {
            TRACKING_SERVER: 'heartbeat tracking server',
            PUBLISHER: 'publisher id',
            CHANNEL: 'channel',
            OVP: 'ovp name',
            SDK: 'sgk version',
       SSL: 'false',
       DEBUG: 'true'
        }
    };
})();
```


(function() { &#39;use ict&#39;;     // Exportar símbolos.
    window.Configuration = { PLAYER: { NOME: &#39;nome do reprodutor de exemplo&#39; //VIDEO_ID: &#39;ID de vídeo de exemplo&#39;, //VIDEO_NAME: nome do vídeo de exemplo&#39; }, VISITOR: { MARKETING_CLOUD_ORG_ID: &#39;experience cloud ID&#39;, TRACKING_SERVER: &#39;servidor de rastreamento&#39;, DPID: &#39;&#39;, DPUUID: &#39;&#39; }, APP_MEASUREMENT: { RSID: &#39;id do conjunto de relatórios&#39;, TRACKING_SERVER: &#39;servidor de rastreamento&#39;, PAGE_NAME: &#39;nome da página&#39;, CHAR_SET: &#39;UTF-8&#39; }, HEARTBEAT: { TRACKING_SERVER: &#39;servidor de rastreamento de pulsação&#39;, PUBLISHER: &#39;publisher id&#39;, CANAL: &quot;channel&quot;, OVP: &#39;ovp name&#39;, SDK: &#39;versão do sgk&#39;, SSL: &#39;false&#39;, DEBUG: &#39;true&#39; }; })();



<b>ETAPA 4: Adicionar ações Serviço de ID de visitante</b>

O Media Analytics precisa de uma instância do Serviço de ID de visitante. É necessário baixar o código do Serviço de ID de visitante do Gerenciador de código na interface do usuário do Adobe Analytics.

Depois de baixar o código do Serviço de ID do visitante, clique no botão + em ações para criar um novo item de ação e, em seguida,

1. Selecione &quot;Principal&quot; no menu suspenso Extensão.
2. Selecione &quot;Código personalizado&quot; no menu suspenso Tipo de ação .
3. Adicione o nome da Ação na caixa de texto Nome.
4. Selecione &quot;Javascript&quot; em Idioma.
5. Marque &quot;Executar globalmente&quot;.
6. Clique em &quot;Abrir editor&quot;.
7. Na parte inferior, adicione o seguinte código e clique em salvar.
8. Na parte inferior, adicione o seguinte código e clique em salvar.


var visitor = Visitor.getInstance(&quot;ID do Experience Cloud&quot;, { trackingServer: &quot;servidor de rastreamento&quot;, // igual a s.trackingServer trackingServerSecure: &quot; servidor de rastreamento &quot; // igual a s.trackingServerSecure });

<b>ETAPA 5: Adicionar ações - Código do Appmeasurement</b>

O Media Analytics precisa de uma instância do Appmeasurement. Você precisaria baixá-lo do Gerenciador de código na interface do usuário do Adobe Analytics.

Depois de baixar o código do Appmeasurement, clique no botão + em ações para criar um novo item de ação e, em seguida,

1. Selecione &quot;Principal&quot; no menu suspenso Extensão.
2. Selecione &quot;Código personalizado&quot; no menu suspenso Tipo de ação .
3. Adicione o nome da Ação na caixa de texto Nome.
4. Selecione &quot;Javascript&quot; em Idioma.
5. Marque &quot;Executar globalmente&quot;.
6. Clique em &quot;Abrir editor&quot;.
7. Adicionar o código do Serviço de ID de visitante.
8. Na parte superior, adicione o seguinte código e clique em salvar.

<br><br><br>// Inicializar AppMeasurement
<br>var s_account=&quot;report suite id&quot;
<br>var s=s_gi(s_account)
<br>/\ *\ *\ *\ *\ *\ *\ *\ *\ * CONFIGURAÇÃO DO SERVIÇO DE ID DE VISITANTE - REQUER VisitorAPI.js \*\ *\ *\ *\ *\ *\ *\ */
<br>s.visitor=Visitor.getInstance(&quot;Experience Cloud ID&quot;)<br><br><br>
<b>ETAPA 6: Adicionar ações - Código do Heartbeat</b>

Baixar o SDK do Heartbeat de [https://github.com/Adobe-Marketing-Cloud/media-sdks/tree/master/sdks/js/libs](https://github.com/Adobe-Marketing-Cloud/media-sdks/tree/master/sdks/js/libs).

Depois de baixar o código do Heartbeat, clique no botão + em ações para criar um novo item de ação e, em seguida,

1. Selecione &quot;Principal&quot; no menu suspenso Extensão.
2. Selecione &quot;Código personalizado&quot; no menu suspenso Tipo de ação .
3. Adicione o nome da Ação na caixa de texto Nome.
4. Selecione &quot;Javascript&quot; em Idioma.
5. Marque &quot;Executar globalmente&quot;.
6. Clique em &quot;Abrir editor&quot;.
7. Adicionar o código do Serviço de ID de visitante.
8. Na parte inferior, adicione o seguinte código e clique em salvar.


//Criar uma referência local para as classes MediaHeartbeat

var MediaHeartbeat = ADB.va.MediaHeartbeat; var MediaHeartbeatConfig = ADB.va.MediaHeartbeatConfig; var MediaHeartbeatDelegate = ADB.va.MediaHeartbeatDelegate;

//Inicialização do Media Heartbeat

var mediaConfig = new MediaHeartbeatConfig(); mediaConfig.trackingServer = Configuration.HEARTBEAT.TRACKING_SERVER; mediaConfig.playerName = Configuration.PLAYER.NAME; mediaConfig.channel = Configuration.HEARTBEAT.CHANNEL; mediaConfig.debugLogging = Configuration.HEARTBEAT.DEBUG;

mediaConfig.appVersion = Configuration.HEARTBEAT.SDK; mediaConfig.ssl = Configuration.HEARTBEAT.SDK; mediaConfig.ovp = Configuration.HEARTBEAT.OVP;

// Implemente o protocolo MediaHeartbeatDelegate .
var mediaDelegate = new MediaHeartbeatDelegate();

// Inicializar

var appMeasurement = new AppMeasurement(); appMeasurement.visitor = visitor; appMeasurement.trackingServer = Configuration.APP_MEASUREMENT.TRACKING_SERVER; appMeasurement.account = Configuration.APP_MEASUREMENT.RSID; appMeasurement.pageName = Configuration.APP_MEASUREMENT.PAGE_NAME; appMeasurement.charSet = Configuration.APP_MEASUREMENT.CHAR_SET; var contextData = { pageURL: document.URL, isUserLoggedIn: &quot;false&quot;, tvStation: &quot;Sample TV station&quot;, programador: &quot;Khurshid Alam&quot; }; var mediaInfo; var videostarted = false; var metaDataLoaded = false;



<b>ETAPA 7: Adicionar ações - Código da API do YouTube IFrame</b>

1. Selecione &quot;Principal&quot; no menu suspenso Extensão.
2. Selecione &quot;Código personalizado&quot; no menu suspenso Tipo de ação .
3. Adicione o nome da Ação na caixa de texto Nome.
4. Selecione &quot;Javascript&quot; em Idioma.
5. Marque &quot;Executar globalmente&quot;.
6. Clique em &quot;Abrir editor&quot;.
7. Adicione o código a seguir e clique em salvar.


// 2. Esse código carrega o código da API do IFrame Player de forma assíncrona.

var tag = document.createElement(&#39;script&#39;); tag.src = &quot;https://www.youtube.com/iframe_api&quot;; var firstScriptTag = document.getElementsByTagName(&#39;script&#39;)0; firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

// 3. Essa função cria um iframe (e um reprodutor do YouTube) // depois que o código da API é baixado.

var player; função onYouTubeIframeAPIReady() { console.log(&quot;onYouTubeIframeAPIReady chamado...&quot;);        player = new YT.Player(&#39;player&#39;, { height: &quot;390&quot;, largura: &#39;640&#39;, videoId: &#39;xWYHvIjvMnY&#39;, eventos: { &#39;onReady&#39;: onPlayerReady, &#39;onStateChange&#39;: onPlayerStateChange, &#39;onPlaybackQualityChange&#39;: onPlayerPlaybackQualityChange, &#39;onPlaybackRateChange&#39;: onPlayerPlaybackRateChange, &#39;onError&#39;: onPlayerError } }); }

// 4. A API chamará essa função quando o reprodutor de vídeo estiver pronto.

function onPlayerReady(event) { metaDataLoaded = true;        player.playVideo(); }

// 5. A API chama essa função quando o estado do player muda.
// A função indica que, ao reproduzir um vídeo (state=1), // o reprodutor deve reproduzir por seis segundos e depois parar.

function onPlayerStateChange(event) { switch (event.data){ case YT.PlayerState.PLAYING:  console.log(&quot;\*\ *\*HB Playing&quot;);                      if(metaDataLoaded){ if (Math.floor(event.target.getCurrentTime()) == 0) { console.log(&quot;\*\ *\*HB Start&quot;);                                    MediaHeartbeat = ADB.va.MediaHeartbeat;                                    mediaInfo = MediaHeartbeat.createMediaObject( event.target.getVideoData().title, event.target.getVideoData().video_id, Math.floor(event.target.getDuration()), MediaHeartbeat.StreamType.VOD );                                     MediaHeartbeat = new MediaHeartbeat(mediaDelegate, mediaConfig, appMeasurement);                                    mediaDelegate.getCurrentPlaybackTime = function() { return Math.floor(event.target.getCurrentTime());                            };                                    MediaHeartbeat.trackSessionStart(mediaInfo, contextData);                                    MediaHeartbeat.trackPlay();                                    videostarted = true;                      } else { console.log(&quot;\*\ *\*HB Play&quot;);                            MediaHeartbeat.trackPlay();                      }} break;               caso YT.PlayerState.PAUSED:                      console.log(&quot;\*\ *\*Pausar HB&quot;);                      MediaHeartbeat.trackPause();                      quebra;               caso YT.PlayerState.ENDED:                      console.log(&quot;\*\ *\*HB Encerrado&quot;);                      MediaHeartbeat.trackComplete();                      MediaHeartbeat.trackSessionEnd();                      quebra;               caso -1:                      console.log(&quot;\*\ *\*HB Unloaded&quot;);                      MediaHeartbeat.trackComplete();                      MediaHeartbeat.trackSessionEnd();                      quebra;        }

}

function onPlayerPlaybackQualityChange(event) { console.log(&quot;onPlayerPlaybackQualityChange: event.data: &quot;+ event.data); }

function onPlayerPlaybackRateChange(event) { console.log(&quot;onPlayerPlaybackRateChange: event.data: &quot;+ event.data); }

function onPlayerError(event) { console.log(&quot;onPlayerError: event.data: &quot;+ event.data); }



<b>ETAPA 8: Adicionar HTML</b>

Adicione o seguinte código no código HTML.

!-- 1. O iframe (e o reprodutor de vídeo) substituirá essa tag div. — div id=&quot;player&quot;/divbr

<b>ETAPA 8: Publicar</b>

Publique sua propriedade e teste.


