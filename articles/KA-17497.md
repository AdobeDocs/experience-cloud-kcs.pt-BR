---
title: "Descubra quais solicitações AEM o cache do Dispatcher"
description: Descrição
solution: Experience Manager
product: Experience Manager
applies-to: "Experience Manager"
keywords: “KCS”
resolution: Resolution
internal-notes: null
bug: false
article-created-by: Roxann McGlumphy
article-created-date: "12/2/2022 9:08:56 PM"
article-published-by: Nayanika Chakravarty
article-published-date: "3/23/2023 5:12:49 PM"
version-number: 2
article-number: KA-17497
dynamics-url: "https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=0534af84-8572-ed11-9561-6045bd006079"
source-git-commit: 067464d20ff3960470a3ded0dcd15a8d6dbbc37b
workflow-type: tm+mt
source-wordcount: '440'
ht-degree: 7%

---

# Descubra quais solicitações AEM o cache do Dispatcher

## Descrição {#description}

<br>Problema<br><br>
Precisa determinar por que a solicitação/resposta HTTP não está sendo armazenada em cache pelo Dispatcher AEM
<br><br>Ambiente<br><br>
AEM Dispatcher 4.3.3


## Resolução {#resolution}


A documentação abrange os cenários mais importantes que afetam a capacidade de cache de solicitações e respostas que passam pelo módulo Dispatcher AEM. Todas as regras de cache não são abordadas.

<b>Solicitação HTTP e regras de cache</b>

Para que uma solicitação HTTP possa ser armazenada em cache pelo dispatcher, ela deve seguir as seguintes regras:

1. O URL é absoluto (não está funcionando com . ou ..), tem uma extensão de arquivo e o nome do arquivo no URL funciona como um arquivo no sistema de arquivos.
   <b>Mensagens de log relacionadas:</b>


   ```
   URI not canonical: %s.    
   Unable to map URI to file: %s.    
   cache file path too long    
   temporary file path too long    
   request URL has no extension
   ```



   <b>Exemplos:</b>


   | `/content/test` | não armazenado em cache |
   | --- | --- |
   | `/content/test.html` | em cache |


2. Não tem barras após a primeira extensão de arquivo.<br>

   <b>Mensagens de log relacionadas:</b>


   ```
   request URL has trailing slash
   ```



   <b>Exemplos:</b>


   | `/content/test.html/` | não armazenado em cache |
   | --- | --- |
   | `/content/test.html/foo.jpg` | não armazenado em cache |
   | `/content/test.html` | em cache |


3. Ele usa o método HTTP GET ou HEAD.<br>

   <b>Mensagens de log relacionadas:</b>


   ```
   request method is neither GET nor HEAD
   ```



   <b>Exemplos:</b>


   | `HEAD /content/test.html HTTP/1.1` | em cache |
   | --- | --- |
   | `GET /content/dam/test.jpg HTTP/1.1` | não armazenado em cache |
   | `POST /content/test.html HTTP/1.1` | não armazenado em cache |


4. A solicitação é negada por /CACHE = /REGRAS definidas no dispatcher. QUALQUER CONFIGURAÇÃO DE FARM.
   <b>Mensagens de log relacionadas:</b>


   ```
   URI not  in cache rules: %s request URL not in cache rules
   ```



   <b>Exemplos:</b>


   | <br><br>    ```<br>    Farm has /cache = /rules and a request is received for /content/test.html<br>        /cache<br>        {<br>         ...<br>         /rules<br>         {<br>          /0001 {<br>          type "deny"<br>          glob "*"<br>          }<br>         }<br>        }<br>    ```<br><br> | não armazenado em cache |
   | --- | --- |
   | <br><br>    ```<br>    Farm has /cache = /rules and a request is received for /content/test.html<br>        /cache<br>        {<br>         ...<br>         /rules<br>         {<br>          /0001 {<br>          type "allow"<br>          glob "*"<br>          }<br>         }<br>        }<br>    ```<br><br> | em cache |


5. A solicitação HTTP não contém um cabeçalho de autorização ou contém o cabeçalho, mas /ALLOWAUTHORIZED é definido como 1 na CONFIGURAÇÃO DE FARM.
   <b>Mensagens de log relacionadas:</b>


   ```
   request contains authorization
   ```



   <b>Exemplos:</b>


   | Solicitação HTTP:<br><br>    ```<br>    GET /content/test.html HTTP/1.1    Authorization: Basic YWxhZGRpbjpvcGVuc2VzYW1l<br>        dispatcher.any farm /cache = /allowAuthorized configuration:<br>        /cache {<br>           /allowAuthorized “0”    }<br>    ```<br><br> | não armazenado em cache |
   | --- | --- |
   | Solicitação HTTP:<br><br>    ```<br>    GET /content/test.html HTTP/1.1    Authorization: Basic YWxhZGRpbjpvcGVuc2VzYW1l<br>        dispatcher.any farm /cache = /allowAuthorized configuration:<br>        /cache {<br>           /allowAuthorized “1”    }<br>    ```<br><br> | em cache |


6. A solicitação HTTP contém LOGIN-TOKEN ou AUTHORIZATION COOKIE no cabeçalho do cookie ou contém (ou ambos) esses cookies e /ALLOWAUTHORIZED é definido como 1 na CONFIGURAÇÃO DO FARM.
   <b>Mensagens de log relacionadas:</b>


   ```
   request contains authorization
   ```



   <b>Exemplos:</b>


   | Solicitação HTTP:<br><br>    ```<br>    GET /content/test.html HTTP/1.1    Cookie: login-token=…<br>        dispatcher.any farm /cache = /allowAuthorized configuration:<br>        /cache {<br>           /allowAuthorized “0”    }<br>    ```<br><br> | não armazenado em cache |
   | --- | --- |
   | Solicitação HTTP:<br><br>    ```<br>    GET /content/test.html HTTP/1.1    Cookie: authorization=YWxhZGRpbjpvcGVuc2VzYW1l<br>        dispatcher.any farm /cache = /allowAuthorized configuration:<br>        /cache {<br>           /allowAuthorized “0”    }<br>    ```<br><br> | não armazenado em cache |
   | Solicitação HTTP:<br><br>    ```<br>    GET /content/test.html HTTP/1.1    Cookie: login-token=…<br>        dispatcher.any farm /cache = /allowAuthorized configuration:<br>        /cache {<br>           /allowAuthorized “1”    }<br>    ```<br><br> | em cache |


7. Há um parâmetro QUERYSTRING no URL e o parâmetro pode ser ignorado por meio da CONFIGURAÇÃO DE FARM /IGNOREURLPARAMS.
   <b>Mensagens de log relacionadas:</b>


   ```
   request contains a query string
   ```



   <b>Exemplos:</b>


   | Solicitação HTTP:<br><br>    ```<br>    GET /content/test.html?test=1 HTTP/1.1    Farm /cache configuration:<br>        /ignoreUrlParams {     /0001 { /type “allow” /glob “*” }    }<br>    ```<br><br> | em cache |
   | --- | --- |
   | Solicitação HTTP:<br><br>    ```<br>    GET /content/test.html?test=1 HTTP/1.1    Farm /cache configuration:<br>        /ignoreUrlParams {     /0001 { /type “deny” /glob “*” } <br>           /0001 { /type “allow” /glob “test” }    }<br>    ```<br><br> | em cache |
   | Solicitação HTTP:<br><br>    ```<br>    GET /content/test.html?test=1 HTTP/1.1    dispatcher.any farm /cache = /allowAuthorized configuration:<br>        /ignoreUrlParams {<br>         /0001 { /type “deny” /glob “*” } <br>           /0001 { /type “allow” /glob “q” }    }<br>    ```<br><br> | não armazenado em cache |



<b>Resposta HTTP e regras de cache:</b>

A resposta HTTP retornada do AEM pode ser armazenada em cache se os seguintes critérios forem atendidos:

1. O dispatcher pode enviar e receber uma resposta 200 OK de um dos &quot;RENDERS&quot; definidos.

   <b>Observação:</b> Se não [/timeout](https://experienceleague.adobe.com/docs/experience-manager-dispatcher/using/configuring/dispatcher-configuration.html?lang=pt-BR) estiver definido em /renders ou estiver definido como 0, aguardará para sempre uma conexão com a instância AEM mesmo se a instância estiver inativa.
   <b>Mensagens de log relacionadas:</b>


   ```
   Unable to send request to remote server. Unable to receive response from remote server. Remote server returned: %s No backend available.
   ```



   <b>Exemplos:</b>


   | Solicitação HTTP:<br><br>    200 OK | em cache |
   | --- | --- |
   | Solicitação HTTP:<br><br>    404 Página não encontrada | não armazenado em cache |


2. Nenhum desses cabeçalhos de resposta está presente na resposta:

   - `Dispatcher: no-cache`
   - `Cache-control: no-cache`
   - `Pragma: no-cache`

   <b>Mensagens de log relacionadas:</b>


   ```
   Backend forbids caching: %s, sent: %s" response contains no_cache
   ```



   <b>Exemplos:</b>


   | Resposta HTTP:<br><br>    200 OK<br><br>    Dispatcher: no-cache | não armazenado em cache |
   | --- | --- |
   | Resposta HTTP:<br>    <br><br>    200 OK<br><br>    Controle de cache: no-cache | não armazenado em cache |
   | Resposta HTTP:<br><br>    200 OK<br><br>    Pragma: no-cache | não armazenado em cache |
   | Resposta HTTP:<br><br>    200 OK<br> | em cache |


3. O valor de comprimento do conteúdo é maior que ZERO BYTES.
   <b>Mensagens de log relacionadas:</b>


   ```
   response content length is zero
   ```



   <b>Exemplos:</b>


   | Resposta HTTP:<br><br>    200 OK<br><br>    Duração do conteúdo: 0 | não armazenado em cache |
   | --- | --- |
   | Resposta HTTP:<br><br>    200 OK<br><br>    Duração do conteúdo: 3120 | em cache |


